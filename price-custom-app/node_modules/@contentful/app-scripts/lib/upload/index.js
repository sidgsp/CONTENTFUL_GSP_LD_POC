"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.upload = void 0;
const activate_bundle_1 = require("../activate/activate-bundle");
const get_upload_settings_args_1 = require("./get-upload-settings-args");
const create_app_bundle_1 = require("./create-app-bundle");
const build_upload_settings_1 = require("./build-upload-settings");
async function uploadAndActivate(settings) {
    const bundle = await (0, create_app_bundle_1.createAppBundleFromSettings)(settings);
    if (!settings.skipActivation && bundle) {
        await (0, activate_bundle_1.activateBundle)({ ...settings, bundleId: bundle.sys.id });
    }
}
const interactive = async (options) => {
    const settings = await (0, build_upload_settings_1.buildAppUploadSettings)(options);
    await uploadAndActivate(settings);
};
const nonInteractive = async (options) => {
    const settings = await (0, get_upload_settings_args_1.getUploadSettingsArgs)(options);
    await uploadAndActivate(settings);
};
exports.upload = {
    interactive,
    nonInteractive,
};
